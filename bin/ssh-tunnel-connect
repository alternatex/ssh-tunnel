#!/usr/bin/env node

var path = require('path');
var dirname = path.dirname;
var basename = path.basename;

var program = require('commander');
program.parse(process.argv);

if(program.args.length!==1){
  var colors = require('colors');
  throw new Error((basename(__filename)+' accepts exactly one parameter: ').red+'<name>'.white.bold);
}

var connectionId = program.args[0];

var cli = getCLI(program);

cli.connect(connectionId);

console.log("connection is", connectionId);

function getCLI(program){
  var cli = require("../lib/cli");
  var filename = program.file ? program.file : 'tunnel.conf';
  cli.load(filename);
  return cli;
}